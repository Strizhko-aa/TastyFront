<template>
  <div>
    <br>
    <b-container fluid>

          <bar-chart :chart-data="graph" :options="chartOptions"></bar-chart>

    </b-container>
  </div>
</template>

<script>
  import BarChart from './chart/BarChart'


  export default {
    name: 'Rating',
    components: {BarChart},
    data() {
      return {
        temp: null,
        graph: null,
        chartOptions: {
          scales: {
            yAxes: [{
              ticks: {
                //ticks: 8,
                beginAtZero: true,
                fontSize: 16
              },
              labelFontSize: 20,
              gridLines: {
                display: false,
              },
            }],
            xAxes: [{
              gridLines: {
                display: true,
              },
              ticks: {
                fontSize: 16
              },
              scaleLabel: {
                display: true,
                labelString: 'Продажи'
              },
            }]
          },
          legend: {
            display: true,
          },
          responsive: true,
          maintainAspectRatio: false
        }
      }
    },
    methods: {
      getInformationFromServer: function () {
        let _url = store.getters.host + '/admin/rating';
        var jsonLabels = [];
        var jsonData = [];
        this.$http.get(_url).then(response =>
          response.json()).then(json => {
          console.log(json);
          Object.keys(json).forEach(function (key) {
            jsonData.push(key);
            jsonLabels.push(json[key]);
          })
        }).catch(error => {
          console.log(error)
        });
        setTimeout(() => {
          this.graph = {
          labels: jsonData,
          datasets: [
            {
              label: 'Продажи за месяц',
              backgroundColor: 'rgba(63, 147, 132, 0.3)',
              borderColor: 'rgba(63, 147, 132, 1)',
              borderWidth: 1,
              data: jsonLabels
            }
          ]
        };
        }, 500)
      }
    },
    created: function () {
     this.getInformationFromServer();
    }
  }
</script>

<style scoped>

</style>
